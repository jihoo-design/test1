<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>한남한녀 주식회사 경조 회비</title>

    <style>
        body {
            font-family: "맑은 고딕", -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
            background: linear-gradient(135deg, #eceff1, #f5f5f5);
            margin: 0;
            padding: 20px 0;
        }

        /* 전체 앱을 모바일 카드처럼 가운데 정렬 */
        .app {
            max-width: 480px;
            margin: 0 auto;
            background-color: #fdfdfd;
            border-radius: 22px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.15);
            overflow: hidden;
        }

        /* 상단 카톡 느낌 헤더 */
        .app-header {
            background: linear-gradient(135deg, #FEE500, #ffe96b);
            padding: 14px 18px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .header-icon {
            width: 32px;
            height: 32px;
            border-radius: 16px;
            background-color: #3c1e1e;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #FEE500;
            font-weight: bold;
            font-size: 17px;
        }

        .header-text {
            display: flex;
            flex-direction: column;
        }

        .header-text .title {
            font-weight: bold;
            font-size: 16px;
            color: #3c1e1e;
        }

        .header-text .subtitle {
            font-size: 11px;
            color: #5d4037;
        }

        .app-body {
            padding: 16px 14px 20px;
            background-color: #f5f5f5;
        }

        .card {
            background-color: #ffffff;
            border-radius: 18px;
            padding: 14px 14px 12px;
            margin-bottom: 14px;
            box-shadow: 0 2px 7px rgba(0,0,0,0.06);
        }

        .card-title {
            font-weight: 600;
            font-size: 14px;
            margin-bottom: 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .card-title small {
            font-weight: normal;
            font-size: 11px;
            color: #777;
        }

        .input-row {
            display: flex;
            gap: 8px;
            align-items: center;
            flex-wrap: wrap;
            margin-bottom: 6px;
        }

        label {
            font-size: 12px;
            min-width: 80px;
            color: #555;
        }

        input[type="text"],
        input[type="number"] {
            padding: 6px 9px;
            border: 1px solid #d0d0d0;
            border-radius: 10px;
            font-size: 13px;
            background-color: #fafafa;
            transition: border-color 0.15s, box-shadow 0.15s, background-color 0.15s;
        }

        input[type="text"]:focus,
        input[type="number"]:focus {
            outline: none;
            border-color: #ffcc00;
            box-shadow: 0 0 0 2px rgba(255, 204, 0, 0.25);
            background-color: #ffffff;
        }

        input[type="number"] {
            width: 140px;
        }

        button {
            padding: 6px 11px;
            border-radius: 999px;
            border: none;
            cursor: pointer;
            font-size: 12px;
            white-space: nowrap;
            transition: filter 0.15s, transform 0.05s;
        }

        button:active {
            transform: translateY(1px);
        }

        .btn-main {
            background-color: #FEE500;
            color: #3c1e1e;
            font-weight: bold;
        }

        .btn-main:hover {
            filter: brightness(0.96);
        }

        .btn-ghost {
            background-color: #eeeeee;
            color: #444;
        }

        .btn-ghost:hover {
            background-color: #e0e0e0;
        }

        .account-box {
            background-color: #fff8d4;
            border-radius: 14px;
            padding: 10px 12px;
            font-size: 13px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            gap: 8px;
        }

        .account-label {
            font-weight: bold;
            color: #4e342e;
        }

        .account-number {
            font-family: "Consolas", monospace;
            font-weight: bold;
        }

        .info-text {
            font-size: 11px;
            color: #777;
            margin-top: 4px;
            line-height: 1.5;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 6px;
            font-size: 12px;
        }

        th, td {
            border-bottom: 1px solid #eee;
            padding: 6px;
            text-align: center;
        }

        th {
            background-color: #f7f7f7;
            font-weight: bold;
        }

        tr:last-child td {
            border-bottom: none;
        }

        .summary {
            display: flex;
            flex-wrap: wrap;
            gap: 6px;
            margin-top: 8px;
        }

        .summary-item {
            flex: 1 1 45%;
            background-color: #fffbea;
            border-radius: 12px;
            padding: 6px 8px;
            font-size: 11px;
            color: #555;
        }

        .summary-item span.label {
            display: block;
            margin-bottom: 2px;
        }

        .summary-item span.value {
            font-size: 13px;
            font-weight: bold;
        }

        .error-msg {
            color: #d32f2f;
            margin-top: 4px;
            font-size: 11px;
        }

        .checkbox-cell {
            font-size: 11px;
        }

        .checkbox-cell label {
            min-width: 0;
            font-size: 11px;
            color: #555;
        }

        @media (max-width: 480px) {
            .card {
                border-radius: 16px;
            }
        }
    </style>
</head>
<body>

<div class="app">
    <!-- 상단 헤더 -->
    <div class="app-header">
        <div class="header-icon">H</div>
        <div class="header-text">
            <span class="title">한남한녀 주식회사 경조 회비</span>
            <span class="subtitle">회식 / 경조사 N/1 + 추가 정산 계산기</span>
        </div>
    </div>

    <div class="app-body">

        <!-- 회사 계좌 카드 -->
        <div class="card">
            <div class="card-title">
                회사 계좌
                <small>입금 안내용</small>
            </div>
            <div class="account-box">
                <div>
                    <div class="account-label">한남한녀 주식회사 경조 회비 계좌</div>
                    <div class="account-number" id="accountText">
                        기업은행 35112382001015
                    </div>
                </div>
                <button class="btn-ghost" type="button" onclick="copyAccount()">
                    계좌 복사
                </button>
            </div>
            <div class="info-text">
                단톡방에 “계좌 + 1인당 금액”을 같이 보내면 깔끔하게 정산 가능합니다.
            </div>
        </div>

        <!-- 기본 금액 카드 -->
        <div class="card">
            <div class="card-title">
                1. 기본 회식 / 경조 금액
                <small>여기에 4명이서 나눌 금액 입력</small>
            </div>
            <div class="input-row">
                <label for="totalAmount">기본 총 금액</label>
                <input type="number" id="totalAmount" min="0" oninput="updateShares()">
                <span style="font-size:12px;">원</span>
            </div>
            <div class="info-text">
                예) 곽주임, 권부장, 미쓰킴, 발사원이 함께 나눌 전체 금액을 입력합니다.
            </div>
        </div>

        <!-- 추가 정산 카드 -->
        <div class="card">
            <div class="card-title">
                2. 추가 정산 금액
                <small>특정 인원만 더 부담해야 하는 금액</small>
            </div>
            <div class="input-row">
                <label for="extraAmount">추가 총 금액</label>
                <input type="number" id="extraAmount" min="0" oninput="updateShares()">
                <span style="font-size:12px;">원</span>
            </div>
            <div class="input-row">
                <label for="extraPeopleCount">추가 정산 인원 수</label>
                <input type="number" id="extraPeopleCount" min="1" oninput="updateShares()">
                <span style="font-size:12px;">명 (예: 나 + 곽주임 → 2명)</span>
            </div>
            <div class="info-text">
                예) 나와 곽주임이 45,000원을 둘이서 나누면 추가 정산 인원 수는 2명입니다.<br>
                직원 목록에서 “추가” 체크가 된 사람에게만 이 추가 금액이 나눠서 반영됩니다.
            </div>
        </div>

        <!-- 직원 카드 -->
        <div class="card">
            <div class="card-title">
                3. 직원 목록 및 최종 정산
                <small>처음에는 예시 정산 결과가 보입니다.</small>
            </div>
            <div class="input-row">
                <label for="employeeName">직원 이름</label>
                <input type="text" id="employeeName">
                <button class="btn-main" type="button" onclick="addEmployee()">추가</button>
            </div>
            <div id="errorMessage" class="error-msg"></div>

            <table id="employeeTable">
                <thead>
                <tr>
                    <th>직원 이름</th>
                    <th class="checkbox-cell">기본</th>
                    <th class="checkbox-cell">추가</th>
                    <th>최종 부담 금액</th>
                    <th>삭제</th>
                </tr>
                </thead>
                <tbody>
                <!-- 직원 목록이 여기에 추가됨 -->
                </tbody>
            </table>

            <div class="summary">
                <div class="summary-item">
                    <span class="label">인원 수</span>
                    <span class="value" id="summaryCount">0명 (기본 0명 / 추가 0명)</span>
                </div>
                <div class="summary-item">
                    <span class="label">기본 1인당 금액</span>
                    <span class="value" id="summaryBasePer">0원</span>
                </div>
                <div class="summary-item">
                    <span class="label">추가 1인당 금액</span>
                    <span class="value" id="summaryExtraPer">0원</span>
                </div>
                <div class="summary-item">
                    <span class="label">기본 + 추가 총 금액</span>
                    <span class="value" id="summaryTotal">0원</span>
                </div>
            </div>

            <div class="info-text">
                - “기본” 체크: 기본 회식/경조 금액(예: 79,000원)을 N분의 1로 나눌 대상입니다.<br>
                - “추가” 체크: 추가 정산 금액(예: 45,000원)을 나누는 인원 중 직원에게 적용할 대상입니다.<br>
                - 남는 금액은 곽주임이 부담하거나 다음 회식 적립금으로 사용하면 됩니다.
            </div>

            <div class="info-text" id="selfInfo" style="margin-top:6px; font-weight: bold; color:#555;">
                <!-- 나(본인) 부담 안내 텍스트가 여기 들어감 -->
            </div>
        </div>
    </div>
</div>

<script>
    // 계좌 복사
    function copyAccount() {
        const text = document.getElementById("accountText").innerText.trim();

        if (navigator.clipboard && navigator.clipboard.writeText) {
            navigator.clipboard.writeText(text).then(function () {
                alert("계좌번호가 클립보드에 복사되었습니다:\n" + text);
            }).catch(function () {
                alert("복사가 자동으로 안 되면 직접 드래그해서 복사해 주세요.\n\n" + text);
            });
        } else {
            alert("복사가 자동으로 안 되면 직접 드래그해서 복사해 주세요.\n\n" + text);
        }
    }

    // 직원 행 추가 (공통 함수)
    function createEmployeeRow(name, includeBase, includeExtra) {
        const tableBody = document.querySelector("#employeeTable tbody");
        const row = document.createElement("tr");

        // 이름 셀
        const nameCell = document.createElement("td");
        nameCell.textContent = name;
        row.appendChild(nameCell);

        // 기본 정산 포함 체크박스 셀
        const baseCell = document.createElement("td");
        baseCell.className = "checkbox-cell";
        const baseLabel = document.createElement("label");
        baseLabel.style.cursor = "pointer";
        const baseCheckbox = document.createElement("input");
        baseCheckbox.type = "checkbox";
        baseCheckbox.checked = includeBase;
        baseCheckbox.style.marginRight = "4px";
        baseCheckbox.onchange = function () {
            updateShares();
        };
        baseLabel.appendChild(baseCheckbox);
        baseLabel.appendChild(document.createTextNode("기본"));
        baseCell.appendChild(baseLabel);
        row.appendChild(baseCell);

        // 추가 정산 대상 체크박스 셀
        const extraCell = document.createElement("td");
        extraCell.className = "checkbox-cell";
        const extraLabel = document.createElement("label");
        extraLabel.style.cursor = "pointer";
        const extraCheckbox = document.createElement("input");
        extraCheckbox.type = "checkbox";
        extraCheckbox.checked = includeExtra;
        extraCheckbox.style.marginRight = "4px";
        extraCheckbox.onchange = function () {
            updateShares();
        };
        extraLabel.appendChild(extraCheckbox);
        extraLabel.appendChild(document.createTextNode("추가"));
        extraCell.appendChild(extraLabel);
        row.appendChild(extraCell);

        // 최종 부담 금액 셀
        const amountCell = document.createElement("td");
        amountCell.setAttribute("data-amount", "0");
        amountCell.textContent = "-";
        row.appendChild(amountCell);

        // 삭제 버튼 셀
        const deleteCell = document.createElement("td");
        const deleteButton = document.createElement("button");
        deleteButton.textContent = "삭제";
        deleteButton.className = "btn-ghost";
        deleteButton.type = "button";
        deleteButton.onclick = function () {
            row.remove();
            updateShares();
        };
        deleteCell.appendChild(deleteButton);
        row.appendChild(deleteCell);

        tableBody.appendChild(row);
    }

    // 새 직원 추가 (사용자 입력)
    function addEmployee() {
        const nameInput = document.getElementById("employeeName");
        const errorDiv = document.getElementById("errorMessage");
        const name = nameInput.value.trim();

        errorDiv.textContent = "";

        if (name === "") {
            errorDiv.textContent = "직원 이름을 입력해주세요.";
            nameInput.focus();
            return;
        }

        createEmployeeRow(name, true, false);

        nameInput.value = "";
        nameInput.focus();

        updateShares();
    }

    // 정산 계산
    function updateShares() {
        const totalInput = document.getElementById("totalAmount");
        const extraInput = document.getElementById("extraAmount");
        const extraCountInput = document.getElementById("extraPeopleCount");
        const tableBody = document.querySelector("#employeeTable tbody");
        const rows = tableBody.querySelectorAll("tr");

        const spanCount = document.getElementById("summaryCount");
        const spanBasePer = document.getElementById("summaryBasePer");
        const spanExtraPer = document.getElementById("summaryExtraPer");
        const spanTotal = document.getElementById("summaryTotal");
        const selfInfo = document.getElementById("selfInfo");

        let baseTotal = parseInt(totalInput.value.trim(), 10);
        if (isNaN(baseTotal) || baseTotal < 0) {
            baseTotal = 0;
        }

        let extraTotal = parseInt(extraInput.value.trim(), 10);
        if (isNaN(extraTotal) || extraTotal < 0) {
            extraTotal = 0;
        }

        let extraPeopleCount = parseInt(extraCountInput.value.trim(), 10);
        if (isNaN(extraPeopleCount) || extraPeopleCount <= 0) {
            extraPeopleCount = 0;
        }

        const totalCount = rows.length;
        let baseCount = 0;
        let extraTargetCount = 0;

        // 체크된 인원 수 세기
        rows.forEach(function (row) {
            const baseCheckbox = row.children[1].querySelector('input[type="checkbox"]');
            const extraCheckbox = row.children[2].querySelector('input[type="checkbox"]');

            if (baseCheckbox && baseCheckbox.checked) {
                baseCount++;
            }
            if (extraCheckbox && extraCheckbox.checked) {
                extraTargetCount++;
            }
        });

        let basePer = 0;
        let extraPer = 0;

        if (baseCount > 0 && baseTotal > 0) {
            basePer = Math.floor(baseTotal / baseCount);
        }

        if (extraPeopleCount > 0 && extraTotal > 0) {
            // 추가 정산은 "전체 추가 정산 인원 수" 기준으로 나눔
            extraPer = Math.floor(extraTotal / extraPeopleCount);
        }

        let sumForAllEmployees = 0;

        // 각 직원 셀에 최종 금액 채우기
        rows.forEach(function (row) {
            const baseCheckbox = row.children[1].querySelector('input[type="checkbox"]');
            const extraCheckbox = row.children[2].querySelector('input[type="checkbox"]');
            const amountCell = row.children[3]; // 네 번째 셀(최종 금액)

            let basePart = 0;
            let extraPart = 0;

            if (baseCheckbox && baseCheckbox.checked && basePer > 0) {
                basePart = basePer;
            }

            if (extraCheckbox && extraCheckbox.checked && extraPer > 0) {
                extraPart = extraPer;
            }

            const finalAmount = basePart + extraPart;
            sumForAllEmployees += finalAmount;

            if (finalAmount > 0) {
                if (extraPart > 0 && basePart > 0) {
                    amountCell.textContent =
                        finalAmount.toLocaleString("ko-KR") +
                        " 원 (기본 " +
                        basePart.toLocaleString("ko-KR") +
                        " + 추가 " +
                        extraPart.toLocaleString("ko-KR") +
                        ")";
                } else if (basePart > 0) {
                    amountCell.textContent = basePart.toLocaleString("ko-KR") + " 원";
                } else if (extraPart > 0) {
                    amountCell.textContent = extraPart.toLocaleString("ko-KR") + " 원";
                } else {
                    amountCell.textContent = "-";
                }
            } else {
                amountCell.textContent = "-";
            }

            amountCell.setAttribute("data-amount", finalAmount.toString());
        });

        // 요약 영역 업데이트
        spanCount.textContent =
            totalCount +
            "명 (기본 " +
            baseCount +
            "명 / 추가 " +
            extraTargetCount +
            "명)";
        spanBasePer.textContent = basePer.toLocaleString("ko-KR") + "원";
        spanExtraPer.textContent = extraPer.toLocaleString("ko-KR") + "원";
        spanTotal.textContent = sumForAllEmployees.toLocaleString("ko-KR") + "원";

        // "나(본인)" 부담 안내 (추가 정산 금액 기준)
        if (extraTotal > 0 && extraPeopleCount > 0 && extraPer > 0) {
            selfInfo.textContent =
                "※ 참고: 추가 정산 " +
                extraTotal.toLocaleString("ko-KR") +
                "원을 " +
                extraPeopleCount +
                "명이 나누는 경우, 나(본인) 부담 금액은 " +
                extraPer.toLocaleString("ko-KR") +
                "원입니다.";
        } else {
            selfInfo.textContent = "";
        }
    }

    // 초기 세팅: 예시 상황 자동 적용
    window.addEventListener("DOMContentLoaded", function () {
        const totalInput = document.getElementById("totalAmount");
        const extraInput = document.getElementById("extraAmount");
        const extraCountInput = document.getElementById("extraPeopleCount");

        // 예시 값 세팅
        totalInput.value = 79000;      // 4명이서 나눌 금액
        extraInput.value = 45000;      // 나 + 곽주임이 나눌 추가 금액
        extraCountInput.value = 2;     // 나 + 곽주임 → 2명

        // 직원 목록 기본 세팅
        createEmployeeRow("곽주임", true, true);    // 기본 + 추가 대상
        createEmployeeRow("권부장", true, false);   // 기본만
        createEmployeeRow("미쓰킴", true, false);   // 기본만
        createEmployeeRow("발사원", true, false);   // 기본만

        // 초기 계산 반영
        updateShares();
    });
</script>

</body>
</html>
